<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Clarity ¬∑ Sigrid ‚Äî One-Video Focus + Tone ‚ùÑÔ∏è</title>
<meta name="theme-color" content="#0b0d11">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="description" content="Start to play 160/162 Hz binaural + optional 512 Hz shimmer, and exactly one Sigrid video inline on loop. Switch tracks without audio bugs.">
<style>
:root{
  --bg:#0b0d11; --ink:#eaf9ff; --muted:#9fb4c2; --card:#0f1621; --ring:#182232;
  --accent:#9ed0ff; --ok:#89f7d6; --halo:#bee4ff; --gradA:#142032; --gradB:#0b0d11;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink);
  background:radial-gradient(1200px 800px at 50% -10%, var(--gradA) 0%, var(--gradB) 55%);
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}
.header{padding:3rem 1rem 1rem; text-align:center}
h1{margin:0 0 .25rem; font-weight:700; letter-spacing:.02em}
.tag{color:var(--muted); font-size:.95rem}
.wrap{max-width:980px; margin:0 auto; padding:0 1rem 4rem}
.card{
  background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));
  border:1px solid var(--ring); border-radius:16px; padding:1rem; margin:1rem 0; backdrop-filter:blur(6px);
}
.row{display:flex; flex-wrap:wrap; gap:.65rem; align-items:center}
button{
  border:0; border-radius:14px; padding:.9rem 1.2rem; font-weight:650; cursor:pointer;
  background:var(--accent); color:#071018; transition:transform .06s ease, opacity .2s ease, box-shadow .2s ease;
}
button:active{transform:translateY(1px)}
button.ghost{background:transparent; color:var(--ink); border:1px solid var(--ring)}
label.toggle{display:inline-flex; align-items:center; gap:.5rem}
input[type="checkbox"]{width:1.1rem; height:1.1rem}
.small{font-size:.92rem; color:var(--muted)}
.timer{
  font-variant-numeric:tabular-nums; font-weight:750; letter-spacing:.02em;
  background:#0d1522; border:1px solid var(--ring); padding:.5rem .7rem; border-radius:10px;
}
.slider{appearance:none; width:160px; height:6px; border-radius:999px; background:#1a2740; outline:none}
.slider::-webkit-slider-thumb{appearance:none; width:18px; height:18px; border-radius:50%; background:var(--accent); border:1px solid #0c1628}
.sep{height:1px; background:linear-gradient(90deg,transparent,#21304a,transparent); border:0; margin:1rem 0}

/* focus video */
.player{
  position:relative; border-radius:14px; overflow:hidden; border:1px solid var(--ring);
  aspect-ratio:16/9; background:#0d1522; margin-top:.75rem;
}
.player iframe{position:absolute; inset:0; width:100%; height:100%; border:0; border-radius:14px}

/* tracklist */
.list{display:grid; grid-template-columns:1fr; gap:.4rem; margin-top:.75rem}
.track{
  display:flex; gap:.6rem; align-items:center; justify-content:space-between;
  padding:.6rem .8rem; border:1px solid var(--ring); border-radius:10px; background:#0d1522; color:var(--ink);
}
.track button{padding:.45rem .7rem; border-radius:10px; font-size:.9rem; background:#1a2740; color:var(--accent)}
.track .t{white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:70%}
.active{outline:2px solid var(--accent); box-shadow:0 0 0 2px rgba(158,208,255,.25) inset}
.footer{color:var(--muted); text-align:center; padding:1.25rem}
.ribbon{
  position:fixed; top:.65rem; left:50%; transform:translateX(-50%); z-index:3;
  display:flex; gap:.5rem; background:rgba(9,14,22,.88); border:1px solid var(--ring);
  padding:.35rem .5rem; border-radius:999px; backdrop-filter:blur(10px)
}
.ribbon a{display:inline-block; padding:.45rem .75rem; border-radius:999px; background:#0d1522; border:1px solid var(--ring); color:var(--accent); text-decoration:none; font-weight:650; font-size:.92rem}

/* animated Start button */
#start{
  position:relative; isolation:isolate;
  box-shadow:0 0 0 0 rgba(158,208,255,.6), inset 0 0 12px rgba(255,255,255,.15);
}
#start::before,#start::after{
  content:""; position:absolute; inset:-8px; border-radius:18px; z-index:-1;
  background:conic-gradient(from 0deg, transparent 0 30%, rgba(158,208,255,.25) 40% 60%, transparent 70% 100%);
  filter:blur(12px); animation:spin 6s linear infinite;
}
#start::after{inset:-14px; opacity:.6; animation-duration:9s; filter:blur(20px)}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(158,208,255,.45)}70%{box-shadow:0 0 0 18px rgba(158,208,255,0)}100%{box-shadow:0 0 0 0 rgba(158,208,255,0)}}
#start.pulsing{animation:pulse 2.4s ease-out infinite}
.spark{position:absolute; pointer-events:none; width:8px; height:8px; border-radius:50%; background:#eaf9ff; filter:drop-shadow(0 0 12px var(--halo)); opacity:.95; animation:spark .6s ease-out forwards}
@keyframes spark{to{transform:translate(var(--dx),var(--dy)) scale(.2); opacity:0}}
</style>
</head>
<body>
<nav class="ribbon">
  <a href="https://jar.plnt.earth" target="_self" rel="noopener">‚Ü© Jar</a>
  <a href="https://tunes.plnt.earth" target="_self" rel="noopener">üéµ Tunes</a>
</nav>

<header class="header">
  <h1>‚ùÑÔ∏è Sigrid ‚Äî Clarity Focus</h1>
  <div class="tag">Binaural Air (160/162 Hz) + one inline video on loop ‚Äî starts on tap.</div>
</header>

<main class="wrap">
  <section class="card">
    <div class="row">
      <button id="start" class="pulsing">‚ñ∂ Start Session</button>
      <button id="stop" class="ghost" disabled>‚è∏ Stop</button>
      <span class="timer" id="clock">03:00</span>
      <label class="toggle"><input type="checkbox" id="shimmer"> <span>512 Hz shimmer</span></label>
      <label class="toggle"><input type="checkbox" id="softfade" checked> <span>Soft fade</span></label>
      <label class="toggle"><input type="checkbox" id="mute" checked> <span>Muted</span></label>
      <span class="small">Volume</span><input id="vol" type="range" min="0" max="100" value="40" class="slider" />
      <button id="prev" class="ghost">‚üµ Prev</button>
      <button id="next" class="ghost">Next ‚ü∂</button>
      <button id="resync" class="ghost">‚ü≤ Resync</button>
    </div>

    <div class="player" style="margin-top:.75rem">
      <iframe id="yt" title="Sigrid ‚Äî player" allow="autoplay; encrypted-media" allowfullscreen playsinline></iframe>
    </div>

    <hr class="sep">

    <div class="list" id="tracklist"></div>
  </section>
</main>

<footer class="footer">clarity.plnt.earth ‚Äî One-Video Focus + Binaural ¬∑ Headphones recommended</footer>

<script>
/* ---------------- Playlist ---------------- */
var TRACKS = [
  {t:'Strangers', id:'tEddixS-UoU'},
  {t:"Don‚Äôt Kill My Vibe", id:'jJo0MT3wDBs'},
  {t:'Sight of You', id:'ff6KPrgZx8k'},
  {t:'Sucker Punch', id:'KscadEpooPo'},
  {t:'High Five', id:'UxxajLWwzqY'},
  {t:'Mirror', id:'kfwf3H0IflU'},
  {t:'Burning Bridges', id:'HkWlV6j5H5w'},
  {t:'It Gets Dark', id:'2LhJYv8pY-E'},
  {t:'Home To You (Like A Bullet)', id:'rX8FHkXoFfE'},
  {t:'Head On Fire (with Griff)', id:'5jJzy6TIT3w'},
  {t:'Plot Twist', id:'lYPzRy2b08E'},
  {t:'Dynamite (acoustic)', id:'JtTQ_7U3V6E'}
];

/* ---------------- YouTube embed (no external API) ---------------- */
var player = document.getElementById('yt');
var current = 0;
function buildSrc(id, muted) {
  var base = 'https://www.youtube.com/embed/'+id;
  var q = [
    'autoplay=1',
    'mute='+(muted?1:0),
    'loop=1',              // need playlist=id for loop
    'playlist='+id,
    'controls=0',
    'playsinline=1',
    'modestbranding=1',
    'rel=0',
    'enablejsapi=1',
    'origin='+encodeURIComponent(location.origin||'https://clarity.plnt.earth')
  ].join('&');
  return base+'?'+q;
}
function loadIndex(i, keepMute){
  current = (i+TRACKS.length)%TRACKS.length;
  var id = TRACKS[current].id;
  player.src = buildSrc(id, keepMute);
  highlight();
  setTimeout(function(){ send('playVideo'); if(!keepMute && !MUTE.checked){ send('unMute'); setVol(); }}, 350);
}
function send(func, args){
  try{ player.contentWindow.postMessage(JSON.stringify({event:'command', func:func, args:args||[]}), '*'); }catch(e){}
}
function setVol(){
  var v = parseInt(VOL.value,10)||40;
  send('setVolume', [v]);
}

/* ---------------- Tone engine ---------------- */
var ctx,leftOsc,rightOsc,shimOsc,lGain,rGain,sGain,merger;
function ramp(p,to,t){ try{p.linearRampToValueAtTime(to,t);}catch(e){} }
function startTone(){
  if(!ctx){ ctx = new (window.AudioContext||window.webkitAudioContext)(); }
  var now = ctx.currentTime;
  leftOsc = ctx.createOscillator(); rightOsc = ctx.createOscillator();
  lGain = ctx.createGain(); rGain = ctx.createGain();
  leftOsc.type='sine'; rightOsc.type='sine';
  leftOsc.frequency.setValueAtTime(160, now);
  rightOsc.frequency.setValueAtTime(162, now);
  lGain.gain.setValueAtTime(0.0001, now);
  rGain.gain.setValueAtTime(0.0001, now);

  merger = ctx.createChannelMerger(2);
  leftOsc.connect(lGain).connect(merger,0,0);
  rightOsc.connect(rGain).connect(merger,0,1);

  var out = ctx.createGain();
  merger.connect(out).connect(ctx.destination);

  var fade = SOFT.checked ? 2.0 : 0.05;
  ramp(lGain.gain, 0.08, now + fade);
  ramp(rGain.gain, 0.08, now + fade);
  leftOsc.start(); rightOsc.start();

  if(SHIM.checked){
    shimOsc = ctx.createOscillator(); sGain = ctx.createGain();
    shimOsc.type='sine'; shimOsc.frequency.setValueAtTime(512, now);
    sGain.gain.setValueAtTime(0.0001, now);
    ramp(sGain.gain, 0.03, now + fade);
    shimOsc.connect(sGain).connect(ctx.destination); shimOsc.start();
  }
}
function stopTone(){
  if(!ctx) return;
  var now = ctx.currentTime, fade = SOFT.checked ? 1.2 : 0.05;
  try{
    ramp(lGain.gain, 0.0001, now+fade);
    ramp(rGain.gain, 0.0001, now+fade);
    if(sGain) ramp(sGain.gain, 0.0001, now+fade);
    setTimeout(function(){
      try{ leftOsc.stop(); rightOsc.stop(); if(shimOsc) shimOsc.stop(); }catch(e){}
      leftOsc=rightOsc=shimOsc=null; lGain=rGain=sGain=null;
    }, Math.ceil(fade*1000)+80);
  }catch(e){}
}

/* ---------------- UI wiring ---------------- */
var START = document.getElementById('start');
var STOP  = document.getElementById('stop');
var SHIM  = document.getElementById('shimmer');
var SOFT  = document.getElementById('softfade');
var MUTE  = document.getElementById('mute');
var VOL   = document.getElementById('vol');
var PREV  = document.getElementById('prev');
var NEXT  = document.getElementById('next');
var RESYNC= document.getElementById('resync');
var CLOCK = document.getElementById('clock');
var LIST  = document.getElementById('tracklist');
var running=false, timerId=null;

function spark(x,y){
  var host=START.parentElement;
  for(var i=0;i<10;i++){
    var s=document.createElement('div'); s.className='spark';
    var ang=Math.random()*Math.PI*2; var dist=30+Math.random()*40;
    s.style.left=(x - host.getBoundingClientRect().left - 4)+'px';
    s.style.top=(y - host.getBoundingClientRect().top - 4)+'px';
    s.style.setProperty('--dx', Math.cos(ang)*dist+'px');
    s.style.setProperty('--dy', Math.sin(ang)*dist+'px');
    host.appendChild(s);
    (function(el){ setTimeout(function(){ if(el && el.parentNode) el.parentNode.removeChild(el); }, 620); })(s);
  }
}

function buildList(){
  LIST.innerHTML='';
  for(var i=0;i<TRACKS.length;i++){
    (function(idx){
      var row=document.createElement('div'); row.className='track'; row.dataset.i=idx;
      var label=document.createElement('div'); label.className='t'; label.textContent=TRACKS[idx].t;
      var play=document.createElement('button'); play.textContent='Play';
      play.addEventListener('click', function(){ loadIndex(idx, true); if(!MUTE.checked){ setTimeout(function(){ send('unMute'); setVol(); }, 400); } }, {passive:true});
      row.appendChild(label); row.appendChild(play); LIST.appendChild(row);
    })(i);
  }
}
function highlight(){
  var rows=LIST.querySelectorAll('.track');
  for(var i=0;i<rows.length;i++){ rows[i].classList.remove('active'); }
  var r=LIST.querySelector('.track[data-i="'+current+'"]'); if(r) r.classList.add('active');
}

function start(ev){
  if(running) return;
  running=true;
  if(ctx && ctx.state==='suspended'){ ctx.resume(); }
  startTone();
  loadIndex(current, true); // start muted to satisfy autoplay
  setTimeout(function(){
    if(!MUTE.checked){ send('unMute'); setVol(); }
  }, 800);

  // 3:00 timer
  var until=Date.now()+180000;
  CLOCK.textContent='03:00';
  if(timerId) clearInterval(timerId);
  timerId = setInterval(function(){
    var remain=Math.max(0, Math.round((until - Date.now())/1000));
    var m=Math.floor(remain/60), s=remain%60;
    CLOCK.textContent=(m<10?'0':'')+m+':'+(s<10?'0':'')+s;
    if(remain<=0){ clearInterval(timerId); timerId=null; stop(); }
  }, 200);

  START.disabled=true; STOP.disabled=false; START.classList.add('pulsing');
  if(ev && ev.clientX) spark(ev.clientX, ev.clientY);
}

function stop(){
  if(!running) return;
  running=false;
  stopTone();
  // Pause and mute player
  send('mute'); send('pauseVideo');
  if(timerId){ clearInterval(timerId); timerId=null; }
  CLOCK.textContent='03:00';
  START.disabled=false; STOP.disabled=true;
}

START.addEventListener('click', start, {passive:true});
STOP.addEventListener('click', stop, {passive:true});

MUTE.addEventListener('change', function(){
  if(this.checked){ send('mute'); }
  else { send('unMute'); setVol(); }
}, {passive:true});

VOL.addEventListener('input', function(){
  if(!MUTE.checked){ setVol(); }
}, {passive:true});

PREV.addEventListener('click', function(){ loadIndex(current-1, true); if(!MUTE.checked){ setTimeout(function(){ send('unMute'); setVol(); }, 300);} }, {passive:true});
NEXT.addEventListener('click', function(){ loadIndex(current+1, true); if(!MUTE.checked){ setTimeout(function(){ send('unMute'); setVol(); }, 300);} }, {passive:true});
RESYNC.addEventListener('click', function(){ send('playVideo'); if(!MUTE.checked){ send('unMute'); setVol(); } }, {passive:true});

/* init */
buildList(); highlight();
</script>
</body>
</html>
